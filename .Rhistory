library(devtools)
install_github("XiaoZhangryy/iSC.MEB")
setwd("D:/DukeNUS/SCMEB2/Code/Github/iSC.MEB")
usethis::use_pkgdown()
pkgdown::build_site()
setwd("D:/DukeNUS/SCMEB2/Code/Github/iSC.MEB/vignettes_data")
load("DLPFC_151507_151508.rda")
library(Seurat)
load("DLPFC_151507_151508.rda")
rm(seuList)
setwd("D:/DukeNUS/SCMEB2/Code/Github/iSC.MEB/vignettes")
load("DLPFC_151507_151508.rda")
library(Seurat)
load("DLPFC_151507_151508.rda")
githubURL <- "https://github.com/XiaoZhangryy/iSC.MEB/tree/main/vignettes_data/DLPFC_151507_151508.rda?raw=true"
download.file(githubURL,"DLPFC_151507_151508.rda",mode='wb')
setwd("D:/DukeNUS/SCMEB2/RealDataAnalysis/seqFISH")
counts = readRDS("counts.Rds")
meta = readRDS("metadata.Rds")
meta$row = meta$x_global
meta$col = meta$y_global
y = meta$celltype_mapped_refined
id = y!="Low quality" &  y!="ExE endoderm" & y!="Blood progenitors"
meta = meta[id,]
counts = counts[,id]
dim(counts) # 351 52424
dim(meta) # 52424    16
library(Seurat)
seuList <- list()
embryos <- sort(unique(meta$embryo))
slices <- sort(unique(meta$z))
for (i in 1:length(embryos)) {
for (j in 1:length(slices)) {
id = (meta$embryo == embryos[i]) & (meta$z == slices[j])
sample_name <- paste0("E", i, "S", j)
seuList[[sample_name]] <- CreateSeuratObject(counts = counts[, id], min.cells=100, meta.data = meta[id, c("celltype_mapped_refined", "row", "col")])
}
}
sapply(seuList, dim)
library(iSC.MEB)
preobj <- CreateiSCMEBObject(seuList = seuList)
slim_seurat <- function(seu, metanames) {
counts = seu@assays$RNA@counts
meta = seu@meta.data[, metanames]
seu0 = CreateSeuratObject(counts = counts, meta.data = meta)
seu0
}
slim_seuList <- function(seuList, metanames) {
nT = length(seuList)
seuList0 = vector("list", nT)
for (i in 1:nT) {
seuList0[[i]] = slim_seurat(seuList[[i]], metanames)
}
seuList0
}
metanames = c("celltype_mapped_refined", "row", "col")
seuList = slim_seuList(seuList, metanames)
setwd("D:/DukeNUS/SCMEB2/Code/Github/iSC.MEB/vignettes_data")
save(seuList, "seqFISH.rda")
save(seuList, file="seqFISH.rda")
pkgdown::build_site()
pkgdown::build_site()
pkgdown::build_site()
setwd("D:/DukeNUS/SCMEB2/Code/Github/iSC.MEB/vignettes")
library(iSC.MEB)
library(Seurat)
load("seqFISH.rda")
seuList
sapply(seuList, dim)
Genelist <- row.names(seuList[[1]])
preobj <- CreateiSCMEBObject(seuList = seuList, customGenelist = Genelist, verbose = FALSE)
sapply(preobj$seulist, dim)
sapply(preobj@seulist, dim)
iSCMEBObj <-  CreateNeighbors(preobj, radius.upper=10)
iSCMEBObj <-  runPCA(iSCMEBObj, npcs = 15, pca.method = "APCA")
iSCMEBObj <- SetModelParameters(iSCMEBObj, verbose = TRUE)
iSCMEBObj <- iSCMEB(iSCMEBObj, K = 15)
