[{"path":"https://github.com/XiaoZhangryy/iSC.MEB/articles/iSC-MEB.html","id":"install-the-isc-meb","dir":"Articles","previous_headings":"","what":"Install the iSC.MEB","title":"iSC.MEB: installation","text":"vignette provides introduction R package iSC.MEB, function iSC.MEB implements model iSCMEB, integrate spatial clustering analysis method hidden Markov random field using empirical Bayes. package can installed following command Github: install.packages('devtools') devtools::install_github(\"XiaoZhangryy/iSC.MEB\") package can loaded command:","code":"library(\"iSC.MEB\") #> Loading required package: gtools"},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/articles/iSC-MEB.html","id":"setup-on-linux-or-macos-system","dir":"Articles","previous_headings":"","what":"Setup on Linux or MacOS system","title":"iSC.MEB: installation","text":"running big data, users can use following system command set C_stack unlimited case R Error: C stack usage close limit.","code":"ulimit -s unlimited"},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/articles/iSC.MEB.DLPFC.html","id":"fit-an-isc-meb-model","dir":"Articles","previous_headings":"","what":"Fit an iSC.MEB model","title":"iSC.MEB: DLPFC Data Analysis","text":"First, view spatial transcriptomics data Visium platform.","code":"seuList  ## a list including two Seurat object #> [[1]] #> An object of class Seurat  #> 33538 features across 4226 samples within 1 assay  #> Active assay: RNA (33538 features, 0 variable features) #>  #> [[2]] #> An object of class Seurat  #> 33538 features across 4384 samples within 1 assay  #> Active assay: RNA (33538 features, 0 variable features)"},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/articles/iSC.MEB.DLPFC.html","id":"prepare-the-isc-meb-object-","dir":"Articles","previous_headings":"Fit an iSC.MEB model","what":"Prepare the iSC.MEB Object.","title":"iSC.MEB: DLPFC Data Analysis","text":"Create iSCMEBObj object prepare iSC.MEB models.","code":"preobj <- CreateiSCMEBObject(seuList = seuList, verbose = FALSE)"},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/articles/iSC.MEB.DLPFC.html","id":"add-the-model-setting","dir":"Articles","previous_headings":"Fit an iSC.MEB model","what":"Add the model setting","title":"iSC.MEB: DLPFC Data Analysis","text":"","code":"## check the number of genes/features after filtering step preobj@seulist #> [[1]] #> An object of class Seurat  #> 2000 features across 4226 samples within 1 assay  #> Active assay: RNA (2000 features, 1438 variable features) #>  #> [[2]] #> An object of class Seurat  #> 2000 features across 4383 samples within 1 assay  #> Active assay: RNA (2000 features, 1416 variable features) ## Add adjacency matrix list for a iSCMEBObj object to prepare for iSC.MEB model fitting. iSCMEBObj <- CreateNeighbors(preobj, platform = \"Visium\") ## run PCA to get low dimensional embeddings iSCMEBObj <- runPCA(iSCMEBObj, npcs = 15, pca.method = \"APCA\") ## Add a model setting in advance for an iSCMEBObj object. verbose = TRUE helps outputing the ## information in the algorithm. iSCMEBObj <- SetModelParameters(iSCMEBObj, verbose = TRUE)"},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/articles/iSC.MEB.DLPFC.html","id":"fit-isc-meb","dir":"Articles","previous_headings":"Fit an iSC.MEB model","what":"Fit iSC.MEB","title":"iSC.MEB: DLPFC Data Analysis","text":"function iSCMEB, users can specify number clusters \\(K\\) set K integer vector using modified MBIC(BIC) determine \\(K\\). , use user-specified number clusters. function iSCMEB automatically choose optimal path. User can slao using function SelectModel select model.","code":"### Given K iSCMEBObj <- iSCMEB(iSCMEBObj, K = 7) #> fitting ... #>    |                                                                               |                                                                      |   0%   |                                                                               |===================================                                   |  50%   |                                                                               |======================================================================| 100% #> Finish variable initialization  #> K = 7, iter = 2, loglik= -152550.234016, dloglik=0.999929  #> K = 7, iter = 3, loglik= -145442.808691, dloglik=0.046591  #> K = 7, iter = 4, loglik= -141085.041934, dloglik=0.029962  #> K = 7, iter = 5, loglik= -137778.449463, dloglik=0.023437  #> K = 7, iter = 6, loglik= -135316.817558, dloglik=0.017867  #> K = 7, iter = 7, loglik= -133541.340387, dloglik=0.013121  #> K = 7, iter = 8, loglik= -132255.951723, dloglik=0.009625  #> K = 7, iter = 9, loglik= -131041.538594, dloglik=0.009182  #> K = 7, iter = 10, loglik= -130443.439574, dloglik=0.004564  #> K = 7, iter = 11, loglik= -129960.624851, dloglik=0.003701  #> K = 7, iter = 12, loglik= -129559.966222, dloglik=0.003083  #> K = 7, iter = 13, loglik= -129184.197009, dloglik=0.002900  #> K = 7, iter = 14, loglik= -128900.018226, dloglik=0.002200  #> K = 7, iter = 15, loglik= -128666.182769, dloglik=0.001814  #> K = 7, iter = 16, loglik= -128487.728130, dloglik=0.001387  #> K = 7, iter = 17, loglik= -128338.561799, dloglik=0.001161  #> K = 7, iter = 18, loglik= -128245.266503, dloglik=0.000727  #> K = 7, iter = 19, loglik= -128155.197690, dloglik=0.000702  #> K = 7, iter = 20, loglik= -128066.130345, dloglik=0.000695  #> K = 7, iter = 21, loglik= -128001.366648, dloglik=0.000506  #> K = 7, iter = 22, loglik= -127945.931247, dloglik=0.000433  #> K = 7, iter = 23, loglik= -127888.699197, dloglik=0.000447  #> K = 7, iter = 24, loglik= -127835.507022, dloglik=0.000416  #> K = 7, iter = 25, loglik= -127793.032650, dloglik=0.000332 ## backup the fitting results in resList resList <- iSCMEBObj@resList iSCMEBObj <- SelectModel(iSCMEBObj)  LabelList <- lapply(1:2, function(i) iSCMEBObj@seulist[[i]]@meta.data$layer_guess_reordered) ari_151507 <- mclust::adjustedRandIndex(idents(iSCMEBObj)[[1]], LabelList[[1]]) ari_151508 <- mclust::adjustedRandIndex(idents(iSCMEBObj)[[2]], LabelList[[2]]) ari_all <- mclust::adjustedRandIndex(unlist(idents(iSCMEBObj)), unlist(LabelList)) print(ari_151507) #> [1] 0.512867 print(ari_151508) #> [1] 0.543259 print(ari_all) #> [1] 0.5251211"},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/articles/iSC.MEB.DLPFC.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session information","title":"iSC.MEB: DLPFC Data Analysis","text":"","code":"sessionInfo() #> R version 4.1.3 (2022-03-10) #> Platform: x86_64-w64-mingw32/x64 (64-bit) #> Running under: Windows 10 x64 (build 19043) #>  #> Matrix products: default #>  #> locale: #> [1] LC_COLLATE=English_United States.1252  #> [2] LC_CTYPE=English_United States.1252    #> [3] LC_MONETARY=English_United States.1252 #> [4] LC_NUMERIC=C                           #> [5] LC_TIME=English_United States.1252     #> system code page: 936 #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] sp_1.5-0           SeuratObject_4.1.2 Seurat_4.2.0       iSC.MEB_1.0        #> [5] gtools_3.9.3       #>  #> loaded via a namespace (and not attached): #>   [1] GiRaF_1.0.1           systemfonts_1.0.4     plyr_1.8.7            #>   [4] igraph_1.3.5          lazyeval_0.2.2        splines_4.1.3         #>   [7] listenv_0.8.0         scattermore_0.8       ggplot2_3.3.6         #>  [10] digest_0.6.29         htmltools_0.5.3       fansi_1.0.3           #>  [13] magrittr_2.0.3        memoise_2.0.1         tensor_1.5            #>  [16] cluster_2.1.3         ROCR_1.0-11           globals_0.16.1        #>  [19] matrixStats_0.62.0    pkgdown_2.0.6         spatstat.sparse_2.1-1 #>  [22] colorspace_2.0-3      ggrepel_0.9.1         textshaping_0.3.6     #>  [25] xfun_0.30             dplyr_1.0.10          jsonlite_1.8.2        #>  [28] progressr_0.11.0      spatstat.data_2.2-0   survival_3.3-1        #>  [31] zoo_1.8-11            glue_1.6.2            polyclip_1.10-0       #>  [34] gtable_0.3.1          leiden_0.4.3          future.apply_1.9.1    #>  [37] BiocGenerics_0.40.0   abind_1.4-5           scales_1.2.1          #>  [40] DBI_1.1.2             spatstat.random_2.2-0 miniUI_0.1.1.1        #>  [43] Rcpp_1.0.9            viridisLite_0.4.1     xtable_1.8-4          #>  [46] reticulate_1.26       spatstat.core_2.4-4   mclust_5.4.10         #>  [49] stats4_4.1.3          htmlwidgets_1.5.4     httr_1.4.4            #>  [52] RColorBrewer_1.1-3    ellipsis_0.3.2        ica_1.0-3             #>  [55] pkgconfig_2.0.3       sass_0.4.2            uwot_0.1.14           #>  [58] deldir_1.0-6          utf8_1.2.2            tidyselect_1.1.2      #>  [61] rlang_1.0.6           reshape2_1.4.4        later_1.3.0           #>  [64] munsell_0.5.0         tools_4.1.3           cachem_1.0.6          #>  [67] cli_3.2.0             generics_0.1.3        ggridges_0.5.4        #>  [70] evaluate_0.15         stringr_1.4.1         fastmap_1.1.0         #>  [73] yaml_2.3.5            ragg_1.2.2            goftest_1.2-3         #>  [76] knitr_1.38            fs_1.5.2              fitdistrplus_1.1-8    #>  [79] purrr_0.3.4           RANN_2.6.1            pbapply_1.5-0         #>  [82] future_1.28.0         nlme_3.1-157          mime_0.12             #>  [85] formatR_1.12          compiler_4.1.3        rstudioapi_0.13       #>  [88] plotly_4.10.0         png_0.1-7             spatstat.utils_2.3-1  #>  [91] tibble_3.1.8          bslib_0.4.0           stringi_1.7.8         #>  [94] desc_1.4.1            rgeos_0.5-9           lattice_0.20-45       #>  [97] Matrix_1.5-1          vctrs_0.4.2           CompQuadForm_1.4.3    #> [100] pillar_1.8.1          lifecycle_1.0.3       spatstat.geom_2.4-0   #> [103] lmtest_0.9-40         jquerylib_0.1.4       RcppAnnoy_0.0.19      #> [106] data.table_1.14.2     cowplot_1.1.1         irlba_2.3.5.1         #> [109] httpuv_1.6.6          patchwork_1.1.2       R6_2.5.1              #> [112] promises_1.2.0.1      KernSmooth_2.23-20    gridExtra_2.3         #> [115] parallelly_1.32.1     codetools_0.2-18      MASS_7.3-56           #> [118] assertthat_0.2.1      DR.SC_2.9             rprojroot_2.0.3       #> [121] sctransform_0.3.5     S4Vectors_0.32.4      mgcv_1.8-40           #> [124] parallel_4.1.3        grid_4.1.3            rpart_4.1.16          #> [127] tidyr_1.2.1           rmarkdown_2.13        Rtsne_0.16            #> [130] shiny_1.7.2"},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/articles/iSC.MEB.seqFISH.html","id":"fit-an-isc-meb-model","dir":"Articles","previous_headings":"","what":"Fit an iSC.MEB model","title":"iSC.MEB: seqFISH Data Analysis","text":"First, view spatial transcriptomics data Visium platform.","code":"seuList  ## a list including six Seurat object #> [[1]] #> An object of class Seurat  #> 351 features across 10129 samples within 1 assay  #> Active assay: RNA (351 features, 0 variable features) #>  #> [[2]] #> An object of class Seurat  #> 351 features across 7642 samples within 1 assay  #> Active assay: RNA (351 features, 0 variable features) #>  #> [[3]] #> An object of class Seurat  #> 351 features across 7654 samples within 1 assay  #> Active assay: RNA (351 features, 0 variable features) #>  #> [[4]] #> An object of class Seurat  #> 351 features across 6520 samples within 1 assay  #> Active assay: RNA (351 features, 0 variable features) #>  #> [[5]] #> An object of class Seurat  #> 351 features across 11106 samples within 1 assay  #> Active assay: RNA (351 features, 0 variable features) #>  #> [[6]] #> An object of class Seurat  #> 351 features across 9373 samples within 1 assay  #> Active assay: RNA (351 features, 0 variable features)"},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/articles/iSC.MEB.seqFISH.html","id":"prepare-the-isc-meb-object-","dir":"Articles","previous_headings":"Fit an iSC.MEB model","what":"Prepare the iSC.MEB Object.","title":"iSC.MEB: seqFISH Data Analysis","text":"Create iSCMEBObj object prepare iSC.MEB models.","code":"Genelist <- row.names(seuList[[1]]) preobj <- CreateiSCMEBObject(seuList = seuList, customGenelist = Genelist, verbose = FALSE)"},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/articles/iSC.MEB.seqFISH.html","id":"add-the-model-setting","dir":"Articles","previous_headings":"Fit an iSC.MEB model","what":"Add the model setting","title":"iSC.MEB: seqFISH Data Analysis","text":"","code":"## check the number of genes/features after filtering step preobj@seulist #> [[1]] #> An object of class Seurat  #> 351 features across 10072 samples within 1 assay  #> Active assay: RNA (351 features, 0 variable features) #>  #> [[2]] #> An object of class Seurat  #> 351 features across 7594 samples within 1 assay  #> Active assay: RNA (351 features, 0 variable features) #>  #> [[3]] #> An object of class Seurat  #> 351 features across 7638 samples within 1 assay  #> Active assay: RNA (351 features, 0 variable features) #>  #> [[4]] #> An object of class Seurat  #> 351 features across 6499 samples within 1 assay  #> Active assay: RNA (351 features, 0 variable features) #>  #> [[5]] #> An object of class Seurat  #> 351 features across 10861 samples within 1 assay  #> Active assay: RNA (351 features, 0 variable features) #>  #> [[6]] #> An object of class Seurat  #> 351 features across 9136 samples within 1 assay  #> Active assay: RNA (351 features, 0 variable features) ## Add adjacency matrix list for a iSCMEBObj object to prepare for iSC.MEB model fitting. iSCMEBObj <- CreateNeighbors(preobj, radius.upper = 10) ## run PCA to get low dimensional embeddings iSCMEBObj <- runPCA(iSCMEBObj, npcs = 15, pca.method = \"APCA\") ## Add a model setting in advance for an iSCMEBObj object. verbose = TRUE helps outputing the ## information in the algorithm. iSCMEBObj <- SetModelParameters(iSCMEBObj, verbose = TRUE)"},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/articles/iSC.MEB.seqFISH.html","id":"fit-isc-meb","dir":"Articles","previous_headings":"Fit an iSC.MEB model","what":"Fit iSC.MEB","title":"iSC.MEB: seqFISH Data Analysis","text":"function iSCMEB, users can specify number clusters \\(K\\) set K integer vector using modified MBIC(BIC) determine \\(K\\). , use user-specified number clusters. function iSCMEB automatically choose optimal path. User can slao using function SelectModel select model.","code":"iSCMEBObj <- iSCMEB(iSCMEBObj, K = 18) #> fitting ... #>    |                                                                               |                                                                      |   0%   |                                                                               |===================================                                   |  50%   |                                                                               |======================================================================| 100% #> Finish variable initialization  #> K = 18, iter = 2, loglik= -1161071.700516, dloglik=0.999459  #> K = 18, iter = 3, loglik= -1085212.240590, dloglik=0.065336  #> K = 18, iter = 4, loglik= -1031035.819586, dloglik=0.049922  #> K = 18, iter = 5, loglik= -990513.786568, dloglik=0.039302  #> K = 18, iter = 6, loglik= -967494.701840, dloglik=0.023240  #> K = 18, iter = 7, loglik= -949971.970432, dloglik=0.018111  #> K = 18, iter = 8, loglik= -939433.416532, dloglik=0.011094  #> K = 18, iter = 9, loglik= -930551.226332, dloglik=0.009455  #> K = 18, iter = 10, loglik= -924913.688652, dloglik=0.006058  #> K = 18, iter = 11, loglik= -920292.752661, dloglik=0.004996  #> K = 18, iter = 12, loglik= -917273.615988, dloglik=0.003281  #> K = 18, iter = 13, loglik= -914573.258952, dloglik=0.002944  #> K = 18, iter = 14, loglik= -912678.928088, dloglik=0.002071  #> K = 18, iter = 15, loglik= -911371.846654, dloglik=0.001432  #> K = 18, iter = 16, loglik= -910386.135851, dloglik=0.001082  #> K = 18, iter = 17, loglik= -909512.640369, dloglik=0.000959  #> K = 18, iter = 18, loglik= -908766.530687, dloglik=0.000820  #> K = 18, iter = 19, loglik= -908057.541323, dloglik=0.000780  #> K = 18, iter = 20, loglik= -907389.848048, dloglik=0.000735  #> K = 18, iter = 21, loglik= -906793.076059, dloglik=0.000658  #> K = 18, iter = 22, loglik= -906404.168821, dloglik=0.000429  #> K = 18, iter = 23, loglik= -906063.861695, dloglik=0.000375  #> K = 18, iter = 24, loglik= -905688.536544, dloglik=0.000414  #> K = 18, iter = 25, loglik= -905354.249936, dloglik=0.000369 ## backup the fitting results in resList resList <- iSCMEBObj@resList iSCMEBObj <- SelectModel(iSCMEBObj)  LabelList <- lapply(1:6, function(i) iSCMEBObj@seulist[[i]]@meta.data$celltype_mapped_refined) ari_sections <- sapply(1:6, function(i) mclust::adjustedRandIndex(idents(iSCMEBObj)[[i]], LabelList[[i]])) ari_all <- mclust::adjustedRandIndex(unlist(idents(iSCMEBObj)), unlist(LabelList)) print(ari_sections) #> [1] 0.5226030 0.5174105 0.5507542 0.4873262 0.5444391 0.5443645 print(ari_all) #> [1] 0.5162071"},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/articles/iSC.MEB.seqFISH.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session information","title":"iSC.MEB: seqFISH Data Analysis","text":"","code":"sessionInfo() #> R version 4.1.3 (2022-03-10) #> Platform: x86_64-w64-mingw32/x64 (64-bit) #> Running under: Windows 10 x64 (build 19043) #>  #> Matrix products: default #>  #> locale: #> [1] LC_COLLATE=English_United States.1252  #> [2] LC_CTYPE=English_United States.1252    #> [3] LC_MONETARY=English_United States.1252 #> [4] LC_NUMERIC=C                           #> [5] LC_TIME=English_United States.1252     #> system code page: 936 #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] sp_1.5-0           SeuratObject_4.1.2 Seurat_4.2.0       iSC.MEB_1.0        #> [5] gtools_3.9.3       #>  #> loaded via a namespace (and not attached): #>   [1] GiRaF_1.0.1           systemfonts_1.0.4     plyr_1.8.7            #>   [4] igraph_1.3.5          lazyeval_0.2.2        splines_4.1.3         #>   [7] listenv_0.8.0         scattermore_0.8       ggplot2_3.3.6         #>  [10] digest_0.6.29         htmltools_0.5.3       fansi_1.0.3           #>  [13] magrittr_2.0.3        memoise_2.0.1         tensor_1.5            #>  [16] cluster_2.1.3         ROCR_1.0-11           globals_0.16.1        #>  [19] matrixStats_0.62.0    pkgdown_2.0.6         spatstat.sparse_2.1-1 #>  [22] colorspace_2.0-3      ggrepel_0.9.1         textshaping_0.3.6     #>  [25] xfun_0.30             dplyr_1.0.10          jsonlite_1.8.2        #>  [28] progressr_0.11.0      spatstat.data_2.2-0   survival_3.3-1        #>  [31] zoo_1.8-11            glue_1.6.2            polyclip_1.10-0       #>  [34] gtable_0.3.1          leiden_0.4.3          future.apply_1.9.1    #>  [37] BiocGenerics_0.40.0   abind_1.4-5           scales_1.2.1          #>  [40] DBI_1.1.2             spatstat.random_2.2-0 miniUI_0.1.1.1        #>  [43] Rcpp_1.0.9            viridisLite_0.4.1     xtable_1.8-4          #>  [46] reticulate_1.26       spatstat.core_2.4-4   mclust_5.4.10         #>  [49] stats4_4.1.3          htmlwidgets_1.5.4     httr_1.4.4            #>  [52] RColorBrewer_1.1-3    ellipsis_0.3.2        ica_1.0-3             #>  [55] pkgconfig_2.0.3       sass_0.4.2            uwot_0.1.14           #>  [58] deldir_1.0-6          utf8_1.2.2            tidyselect_1.1.2      #>  [61] rlang_1.0.6           reshape2_1.4.4        later_1.3.0           #>  [64] munsell_0.5.0         tools_4.1.3           cachem_1.0.6          #>  [67] cli_3.2.0             generics_0.1.3        ggridges_0.5.4        #>  [70] evaluate_0.15         stringr_1.4.1         fastmap_1.1.0         #>  [73] yaml_2.3.5            ragg_1.2.2            goftest_1.2-3         #>  [76] knitr_1.38            fs_1.5.2              fitdistrplus_1.1-8    #>  [79] purrr_0.3.4           RANN_2.6.1            pbapply_1.5-0         #>  [82] future_1.28.0         nlme_3.1-157          mime_0.12             #>  [85] formatR_1.12          compiler_4.1.3        rstudioapi_0.13       #>  [88] plotly_4.10.0         png_0.1-7             spatstat.utils_2.3-1  #>  [91] tibble_3.1.8          bslib_0.4.0           stringi_1.7.8         #>  [94] desc_1.4.1            rgeos_0.5-9           lattice_0.20-45       #>  [97] Matrix_1.5-1          vctrs_0.4.2           CompQuadForm_1.4.3    #> [100] pillar_1.8.1          lifecycle_1.0.3       spatstat.geom_2.4-0   #> [103] lmtest_0.9-40         jquerylib_0.1.4       RcppAnnoy_0.0.19      #> [106] data.table_1.14.2     cowplot_1.1.1         irlba_2.3.5.1         #> [109] httpuv_1.6.6          patchwork_1.1.2       R6_2.5.1              #> [112] promises_1.2.0.1      KernSmooth_2.23-20    gridExtra_2.3         #> [115] parallelly_1.32.1     codetools_0.2-18      MASS_7.3-56           #> [118] assertthat_0.2.1      DR.SC_2.9             rprojroot_2.0.3       #> [121] sctransform_0.3.5     S4Vectors_0.32.4      mgcv_1.8-40           #> [124] parallel_4.1.3        grid_4.1.3            rpart_4.1.16          #> [127] tidyr_1.2.1           rmarkdown_2.13        Rtsne_0.16            #> [130] shiny_1.7.2"},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Xiao Zhang. Author, maintainer. Wei Liu. Author, maintainer. Jin Liu. Author.","code":""},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Zhang X, Liu W, Liu J (2022). iSC.MEB: Integrated spatial clustering hidden Markov random field using empirical Bayes. R package version 1.0, https://github.com/XiaoZhangryy/iSC.MEB.","code":"@Manual{,   title = {iSC.MEB: Integrated spatial clustering with hidden Markov random field using empirical Bayes},   author = {Xiao Zhang and Wei Liu and Jin Liu},   year = {2022},   note = {R package version 1.0},   url = {https://github.com/XiaoZhangryy/iSC.MEB}, }"},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/index.html","id":"iscmeb","dir":"","previous_headings":"","what":"Integrated spatial clustering with hidden Markov random field using empirical Bayes","title":"Integrated spatial clustering with hidden Markov random field using empirical Bayes","text":"iSC.MEB: Integrate spatial clustering analysis hidden Markov random field using empirical Bayes. iSC.MEB package integrating analyzing multiple spatially resolved transcriptomics (SRT) datasets, developed Jin Liu’s lab. Check Package Website complete description methods analyses. iSC.MEB can used compare contrast experimental datasets variety contexts, instance: Across experimental batches Across individuals Across different conditions (.e., case control) Across datasets partially shared cell/domain clusters","code":""},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Integrated spatial clustering with hidden Markov random field using empirical Bayes","text":"install packages “iSC.MEB”, firstly, install ‘devtools’ package. Besides, “iSC.MEB” depends ‘Rcpp’ ‘RcppArmadillo’ package, also requires appropriate setting Rtools Xcode Windows Mac OS/X, respectively.","code":"install.packages(\"devtools\") library(devtools) install_github(\"XiaoZhangryy/iSC.MEB\")"},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"Integrated spatial clustering with hidden Markov random field using empirical Bayes","text":"usage examples guided walkthroughs, check vignettes directory repo. DLPFC data analysis seqFISH data analysis users don’t set system properly, following setup different systems can referred. ## Setup Windows system First, download Rtools; second, add Rtools directory environment variable. Users can follow add Windows PATH Environment Variable.","code":""},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/index.html","id":"setup-on-macos-system","dir":"","previous_headings":"","what":"Setup on MacOS system","title":"Integrated spatial clustering with hidden Markov random field using empirical Bayes","text":"First, install Xcode. Installation Xcode can referred . Second, install “gfortran” compiling C++ Fortran .","code":""},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/index.html","id":"setup-on-linux-system","dir":"","previous_headings":"","what":"Setup on Linux system","title":"Integrated spatial clustering with hidden Markov random field using empirical Bayes","text":"parallel computation Linux, users must use following system command set C_stack unlimited case error R Error: C stack usage close limit. use conda environment Linux system dependent packages (scater) can normally installed, can search R package anaconda.org website. take scater package example, search result https://anaconda.org/bioconda/bioconductor-scater. can install conda environment following command. user using conda environment, dependent packages (scater) normally installed Bioconductor, use following command install dependent packages. dependent packages (DR.SC) normally installed CRAN, use following command install dependent packages.","code":"ulimit -s unlimited conda install -c bioconda bioconductor-scater # install BiocManager if (!require(\"BiocManager\", quietly = TRUE))     install.packages(\"BiocManager\") # install the package on Bioconducter BiocManager::install(c(\"scater\")) # install the package on CRAN install.packages(\"DR.SC\")"},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/index.html","id":"demonstration","dir":"","previous_headings":"","what":"Demonstration","title":"Integrated spatial clustering with hidden Markov random field using empirical Bayes","text":"example typical iSC.MEB usage, please see Package Website demonstration overview functions included iSC.MEB.","code":""},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/CreateiSCMEBObject.html","id":null,"dir":"Reference","previous_headings":"","what":"Create the iSC.MEB object with preprocessing step. — CreateiSCMEBObject","title":"Create the iSC.MEB object with preprocessing step. — CreateiSCMEBObject","text":"Create iSC.MEB object preprocessing step.","code":""},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/CreateiSCMEBObject.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create the iSC.MEB object with preprocessing step. — CreateiSCMEBObject","text":"","code":"CreateiSCMEBObject(   seuList,   project = \"iSC.MEB\",   gene.number = 2000,   selectGenesMethod = \"SPARK-X\",   numCores_sparkx = 1,   customGenelist = NULL,   premin.spots = 20,   premin.features = 20,   postmin.spots = 15,   postmin.features = 15,   rawData.preserve = FALSE,   verbose = TRUE )"},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/CreateiSCMEBObject.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create the iSC.MEB object with preprocessing step. — CreateiSCMEBObject","text":"seuList list consisting Seurat objects, object SRT data batch. default assay Seurat object used data preprocessing followed model fitting. specified format seuList argument can referred details example. project optional string, name project, default \"iSC.MEB\". gene.number optional integer, number top spatially variable genes (SVGs) highly variable  genes (HVGs) chosen. selectGenesMethod optional integer, method select genes sample. supports 'SPARK-X' 'HVGs' select genes now. Users can provide self-selected genes using customGenelist argument. numCores_sparkx optional integer, specify number CPU cores SPARK package use selecting spatial genes. customGenelist optional string vector, list user specified genes used PRECAST model fitting. argument given, SVGs/HVGs selected. premin.spots optional integer, features (genes) retained raw data filtering step least premin.spots number spots, default 20. premin.features optional integer, locations retained raw data filtering step least premin.features number  nonzero-count features (genes), default 20. postmin.spots optional integer, features (genes) retained filtering step common genes selected among data batches least premin.spots number spots, default 15. postmin.features optional integer, locations retained filtering step common genes selected among data batches  least premin.features number  nonzero-count features (genes), default 15. rawData.preserve optional logical value, whether preserve raw seuList data. verbose indictor whether display message creating process.","code":""},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/CreateiSCMEBObject.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create the iSC.MEB object with preprocessing step. — CreateiSCMEBObject","text":"Returns iSC.MEB object prepared iSC.MEB model fitting.","code":""},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/CreateiSCMEBObject.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create the iSC.MEB object with preprocessing step. — CreateiSCMEBObject","text":"seuList list Seurat object component, Seurat object includes raw expression count matrix, spatial coordinates meta data data batch, spatial coordinates information must saved metadata Seurat, named \"row\" \"col\" data batch.","code":""},{"path":[]},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/CreateiSCMEBObject.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create the iSC.MEB object with preprocessing step. — CreateiSCMEBObject","text":"","code":"data(iSCMEBObj_toy) library(Seurat) #> Attaching SeuratObject #> Attaching sp seuList <- iSCMEBObj_toy@seulist ## Check the input of seuList for create iSC.MEB object. ## Check the default assay for each data batch sapply(seuList, DefaultAssay) #> [1] \"RNA\" \"RNA\" ## Check the spatial coordinates in the meta data named \"row\" and \"col\". colnames(seuList[[1]]@meta.data) #> [1] \"orig.ident\"            \"nCount_RNA\"            \"nFeature_RNA\"          #> [4] \"layer_guess_reordered\" \"row\"                   \"col\"                   ## Then create iSC.MEB object using this seuList.  ## For convenience, we show the  user-specified genes' list for creating iSC.MEB object.  ## Users can use SVGs from SPARK-X or HVGs. Genelist <- row.names(seuList[[1]]) iSCMEBObj_toy2 <- CreateiSCMEBObject(seuList, customGenelist=Genelist, verbose=FALSE)"},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/CreateNeighbors.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate adjacency matrix form spatial coordinates. — CreateNeighbors","title":"Calculate adjacency matrix form spatial coordinates. — CreateNeighbors","text":"Calculate adjacency matrix form spatial coordinates.","code":""},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/CreateNeighbors.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate adjacency matrix form spatial coordinates. — CreateNeighbors","text":"","code":"CreateNeighbors(   obj,   platform = c(\"Other\", \"ST\", \"Visium\"),   lower.med = 4,   upper.med = 6,   radius.upper = 100 )  # S3 method for iSCMEBObj CreateNeighbors(   obj,   platform = c(\"Other\", \"ST\", \"Visium\"),   lower.med = 4,   upper.med = 6,   radius.upper = 100 )  # S3 method for list CreateNeighbors(   obj,   platform = c(\"Other\", \"ST\", \"Visium\"),   lower.med = 4,   upper.med = 6,   radius.upper = 100 )"},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/CreateNeighbors.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate adjacency matrix form spatial coordinates. — CreateNeighbors","text":"obj seuList iSCMEBObj object posList. platform string, specify platform provided data, default \"\", support \"ST\" \"Visium\" platform. platform specified \"\", adjacency matrix built based L2 distance. lower.med option parameter determine lower bound median number neighborhoods. provided platform specified \"\". upper.med option parameter determine upper bound median number neighborhoods. provided platform specified \"\". radius.upper option parameter determine search radius upper bound neighborhoods. provided platform specified \"\".","code":""},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/CreateNeighbors.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate adjacency matrix form spatial coordinates. — CreateNeighbors","text":"Returns revised iSCMEBObj object. Returns revised list.","code":""},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/CreateNeighbors.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate adjacency matrix form spatial coordinates. — CreateNeighbors","text":"seuList list Seurat object component, Seurat object includes raw expression count matrix, spatial coordinates meta data data batch, spatial coordinates information must saved metadata Seurat, named \"row\" \"col\" data batch. posList list position information, element can data.frame matrix. element posList data.frame, data.frame contain columns names \"row\" \"col\". element posList matrix, matrices two column matrices.","code":""},{"path":[]},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/CreateNeighbors.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate adjacency matrix form spatial coordinates. — CreateNeighbors","text":"","code":"data(iSCMEBObj_toy) library(Seurat) iSCMEBObj_toy2 <- CreateNeighbors(iSCMEBObj_toy, platform = \"Visium\") #> Neighbors were identified for 4222 out of 4222 spots. #> Neighbors were identified for 4378 out of 4381 spots. ## iSCMEBObj_toy2 <- CreateNeighbors(iSCMEBObj_toy, radius.upper = 10)"},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/embeddings.html","id":null,"dir":"Reference","previous_headings":"","what":"Get the identity of iSC.MEB — embeddings","title":"Get the identity of iSC.MEB — embeddings","text":"Get identity iSC.MEB","code":""},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/embeddings.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get the identity of iSC.MEB — embeddings","text":"","code":"embeddings(obj)  # S3 method for iSCMEBObj embeddings(obj)  # S3 method for iSCSCMEB_Result_ObjectMEBObj embeddings(obj)"},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/embeddings.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get the identity of iSC.MEB — embeddings","text":"obj iSCMEBObj object SCMEB_Result_Object object.","code":""},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/embeddings.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get the identity of iSC.MEB — embeddings","text":"Returns list embedding, whose -th element embedding -th tissue section. Returns list embedding, whose -th element embedding -th tissue section.","code":""},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/embeddings.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get the identity of iSC.MEB — embeddings","text":"SCMEB_Result_Object object contains iSC.MEB solution information. output function fit.iscmeb, main function package.","code":""},{"path":[]},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/embeddings.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get the identity of iSC.MEB — embeddings","text":"","code":"data(iSCMEBObj_toy) EmbeddingsList <- embeddings(iSCMEBObj_toy)"},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/fit.iscmeb.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit a iSC.MEB model. — fit.iscmeb","title":"Fit a iSC.MEB model. — fit.iscmeb","text":"Fit iSC.MEB model.","code":""},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/fit.iscmeb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit a iSC.MEB model. — fit.iscmeb","text":"","code":"fit.iscmeb(   VList,   AdjList,   K,   beta_grid = seq(0, 5, by = 0.2),   maxIter_ICM = 6,   maxIter = 25,   epsLogLik = 1e-05,   verbose = TRUE,   int.model = \"EEE\",   init.start = 1,   Sigma_equal = FALSE,   Sigma_diag = TRUE,   seed = 1,   coreNum = 1,   criteria = c(\"MBIC\", \"MAIC\", \"BIC\", \"AIC\"),   c_penalty = 1 )"},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/fit.iscmeb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit a iSC.MEB model. — fit.iscmeb","text":"VList list PCs log-normalized gene expression matrix. -th element ni * npcs matrtix, ni number spots sample , npcs number PC. provide interface users like define PCs . AdjList list adjacency matrix class dgCMatrix. provide interface users like define adjacency matrix . K integer integer vector, specify candidates number clusters. beta_grid optional vector positive value, candidate set smoothing parameter searched grid-search optimization approach, defualt sequence starts 0, ends 5, increase 0.2. maxIter_ICM optional positive value, represents maximum iterations ICM (6 default). maxIter optional positive value, represents maximum iterations EM (25 default). epsLogLik optional positive vlaue, tolerance vlaue relative variation rate observed pseudo log-loglikelihood value, defualt '1e-5'. verbose optional logical value, whether output information ICM-EM algorithm. int.model optional string, specify Gaussian mixture model used evaluting initial values iSC.MEB, default \"EEE\"; see Mclust models' names. init.start optional number times calculate initial value (1 default). init.start larger 1, initial value determined log likelihood mclust results. Sigma_equal optional logical value, specify whether Sigmaks equal, default FALSE. Sigma_diag optional logical value, specify whether Sigmaks diagonal matrices, default TRUE. seed optional integer, random seed fitting iSC.MEB model. coreNum optional positive integer, means number thread used parallel computating (1 default). criteria string, specify criteria used selecting number clusters, supporting \"MBIC\", \"MAIC\", \"BIC\" \"AIC\" (\"MBIC\" default). c_penalty optional positive value, adjusted constant used MBIC criteria (1 default).","code":""},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/fit.iscmeb.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit a iSC.MEB model. — fit.iscmeb","text":"Returns SCMEB_Result_Object object contains model results.","code":""},{"path":[]},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/fit.iscmeb.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fit a iSC.MEB model. — fit.iscmeb","text":"","code":"data(iSCMEBObj_toy) library(Seurat) XList <- lapply(iSCMEBObj_toy@seulist, function(x) Matrix::t(x@assays$RNA@data)) VList <- runPCA(XList) posList <- lapply(iSCMEBObj_toy@seulist, function(x) x@meta.data[,c(\"row\", \"col\")]) AdjList <- CreateNeighbors(posList, platform = \"Visium\") #> Neighbors were identified for 4222 out of 4222 spots. #> Neighbors were identified for 4378 out of 4381 spots. resList <- fit.iscmeb(VList, AdjList, K=7, maxIter=10) #> Evaluate initial values... #> fitting ... #>    |                                                                               |                                                                      |   0%   |                                                                               |===================================                                   |  50%   |                                                                               |======================================================================| 100% #> Fit SC-MEB2... #> Finish variable initialization  #> K = 7, iter = 2, loglik= -148583.924112, dloglik=0.999931  #> K = 7, iter = 3, loglik= -142378.593319, dloglik=0.041763  #> K = 7, iter = 4, loglik= -138932.559873, dloglik=0.024203  #> K = 7, iter = 5, loglik= -135452.994625, dloglik=0.025045  #> K = 7, iter = 6, loglik= -133626.290687, dloglik=0.013486  #> K = 7, iter = 7, loglik= -132565.279798, dloglik=0.007940  #> K = 7, iter = 8, loglik= -131780.626891, dloglik=0.005919  #> K = 7, iter = 9, loglik= -131009.202464, dloglik=0.005854  #> K = 7, iter = 10, loglik= -130602.705279, dloglik=0.003103"},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/idents.html","id":null,"dir":"Reference","previous_headings":"","what":"Get the identity of iSC.MEB — idents","title":"Get the identity of iSC.MEB — idents","text":"Get identity iSC.MEB","code":""},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/idents.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get the identity of iSC.MEB — idents","text":"","code":"idents(obj)  # S3 method for iSCMEBObj idents(obj)  # S3 method for SCMEB_Result_Object idents(obj)"},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/idents.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get the identity of iSC.MEB — idents","text":"obj iSCMEBObj object SCMEB_Result_Object object.","code":""},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/idents.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get the identity of iSC.MEB — idents","text":"Returns list identity, whose -th element identity -th tissue section. Returns list identity, whose -th element identity -th tissue section.","code":""},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/idents.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get the identity of iSC.MEB — idents","text":"SCMEB_Result_Object object contains iSC.MEB solution information. output function fit.iscmeb, main function package.","code":""},{"path":[]},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/idents.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get the identity of iSC.MEB — idents","text":"","code":"data(iSCMEBObj_toy) IdentsList <- idents(iSCMEBObj_toy)"},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/iSCMEB.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit a iSC.MEB model. — iSCMEB","title":"Fit a iSC.MEB model. — iSCMEB","text":"Fit iSC.MEB model.","code":""},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/iSCMEB.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit a iSC.MEB model. — iSCMEB","text":"","code":"iSCMEB(iSCMEBObj, K = NULL)"},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/iSCMEB.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit a iSC.MEB model. — iSCMEB","text":"iSCMEBObj iSCMEBObj object. K optional integer integer vector, specify candidates number clusters. K=NULL, set 5~12.","code":""},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/iSCMEB.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit a iSC.MEB model. — iSCMEB","text":"Returns revised iSCMEBObj object.","code":""},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/iSCMEB.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fit a iSC.MEB model. — iSCMEB","text":"model results saved slot resList.","code":""},{"path":[]},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/iSCMEB.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fit a iSC.MEB model. — iSCMEB","text":"","code":"data(iSCMEBObj_toy) library(Seurat) iSCMEBObj_toy <- runPCA(iSCMEBObj_toy) #> Warning: No assay specified, setting assay as RNA by default. #> Warning: No assay specified, setting assay as RNA by default. iSCMEBObj_toy <- CreateNeighbors(iSCMEBObj_toy, platform = \"Visium\") #> Neighbors were identified for 4222 out of 4222 spots. #> Neighbors were identified for 4378 out of 4381 spots. iSCMEBObj_toy <- SetModelParameters(iSCMEBObj_toy, maxIter=10) iSCMEBObj_toy <- iSCMEB(iSCMEBObj_toy, K = 7) #> Evaluate initial values... #> fitting ... #>    |                                                                               |                                                                      |   0%   |                                                                               |===================================                                   |  50%   |                                                                               |======================================================================| 100% #> Fit SC-MEB2... #> Finish variable initialization  #> K = 7, iter = 2, loglik= -148639.028750, dloglik=0.999931  #> K = 7, iter = 3, loglik= -142416.378700, dloglik=0.041864  #> K = 7, iter = 4, loglik= -138046.918112, dloglik=0.030681  #> K = 7, iter = 5, loglik= -135153.817759, dloglik=0.020957  #> K = 7, iter = 6, loglik= -133625.320193, dloglik=0.011309  #> K = 7, iter = 7, loglik= -132511.266520, dloglik=0.008337  #> K = 7, iter = 8, loglik= -131724.010584, dloglik=0.005941  #> K = 7, iter = 9, loglik= -131179.790106, dloglik=0.004132  #> K = 7, iter = 10, loglik= -130786.908993, dloglik=0.002995  #> K = 7, iter = 11, loglik= -130507.107250, dloglik=0.002139  #> K = 7, iter = 12, loglik= -130284.749940, dloglik=0.001704  #> K = 7, iter = 13, loglik= -130105.141717, dloglik=0.001379  #> K = 7, iter = 14, loglik= -129958.385584, dloglik=0.001128  #> K = 7, iter = 15, loglik= -129829.964108, dloglik=0.000988  #> K = 7, iter = 16, loglik= -129721.926764, dloglik=0.000832  #> K = 7, iter = 17, loglik= -129631.779150, dloglik=0.000695  #> K = 7, iter = 18, loglik= -129553.580371, dloglik=0.000603  #> K = 7, iter = 19, loglik= -129486.764811, dloglik=0.000516  #> K = 7, iter = 20, loglik= -129430.777383, dloglik=0.000432  #> K = 7, iter = 21, loglik= -129383.961837, dloglik=0.000362  #> K = 7, iter = 22, loglik= -129339.893631, dloglik=0.000341  #> K = 7, iter = 23, loglik= -129301.550683, dloglik=0.000296  #> K = 7, iter = 24, loglik= -129274.973613, dloglik=0.000206  #> K = 7, iter = 25, loglik= -129243.926110, dloglik=0.000240"},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/iSCMEBObj-class.html","id":null,"dir":"Reference","previous_headings":"","what":"Each iSCMEBObj object has a number of slots which store information. — iSCMEBObj-class","title":"Each iSCMEBObj object has a number of slots which store information. — iSCMEBObj-class","text":"iSCMEBObj object number slots store information. Key slots access listed . seuList - list Seurat object component, representing raw expression count matrix, spatial coordinates meta data data batch, spatial coordinates information saved metadata Seurat, named \"row\" \"col\" eahc data batch. seulist - Seurat list preprocessing step preparation iSC.MEB model. AdjList - adjacency matrix list iSCMEBObj object. parameterList - model parameter settings iSCMEBObj object. resList - results fitting iSC.MEB models. project - Name project.","code":""},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/iSCMEBObj_toy.html","id":null,"dir":"Reference","previous_headings":"","what":"A toy data to help user get started with our packages. — iSCMEBObj_toy","title":"A toy data to help user get started with our packages. — iSCMEBObj_toy","text":"toy data help user get started packages.","code":""},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/iSCMEBObj_toy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A toy data to help user get started with our packages. — iSCMEBObj_toy","text":"","code":"data(iSCMEBObj_toy)"},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/iSCMEBObj_toy.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"A toy data to help user get started with our packages. — iSCMEBObj_toy","text":"iSCMEBObj. seulist slot includes list two Seurat data.","code":""},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/runPCA.html","id":null,"dir":"Reference","previous_headings":"","what":"Dimensionality reduction using PCA. — runPCA","title":"Dimensionality reduction using PCA. — runPCA","text":"Dimensionality reduction using PCA.","code":""},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/runPCA.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Dimensionality reduction using PCA. — runPCA","text":"","code":"runPCA(   obj,   npcs = 15,   pca.method = c(\"APCA\", \"PCA\", \"WPCA\"),   reduction.name = \"pca\" )  # S3 method for iSCMEBObj runPCA(   obj,   npcs = 15,   pca.method = c(\"APCA\", \"PCA\", \"WPCA\"),   reduction.name = \"pca\" )  # S3 method for list runPCA(   obj,   npcs = 15,   pca.method = c(\"APCA\", \"PCA\", \"WPCA\"),   reduction.name = \"pca\" )"},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/runPCA.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Dimensionality reduction using PCA. — runPCA","text":"obj seuList iSCMEBObj object matrix list. npcs Total Number PCs compute store (15 default). pca.method string, specify kind PCA used. Supporting \"APCA\" (approximate PCA), \"PCA\" (classical PCA) \"WPCA\" (weighted PCA). Default method APCA. reduction.name Dimensional reduction name, pca default","code":""},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/runPCA.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Dimensionality reduction using PCA. — runPCA","text":"Returns revised iSCMEBObj object input iSCMEBObj. Returns revised list input seuList matrix list.","code":""},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/runPCA.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Dimensionality reduction using PCA. — runPCA","text":"seuList list Seurat object component, Seurat object includes raw expression count matrix, spatial coordinates meta data data batch, spatial coordinates information must saved metadata Seurat, named \"row\" \"col\" data batch. matrix list list log-transformed expression matrix, element columns.","code":""},{"path":[]},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/runPCA.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Dimensionality reduction using PCA. — runPCA","text":"","code":"data(iSCMEBObj_toy) library(Seurat) ## For convenience, we show the iSCMEBObj for perform dimension reduction.  ## Users can use PCA method or WPCA. iSCMEBObj_toy2 <- runPCA(iSCMEBObj_toy) #> Warning: No assay specified, setting assay as RNA by default. #> Warning: No assay specified, setting assay as RNA by default. ## seulist <- iSCMEBObj_toy$seulist ## seulist <- runPCA(seulist)"},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/SelectModel.html","id":null,"dir":"Reference","previous_headings":"","what":"Select best iSC.MEB model from candidated models. — SelectModel","title":"Select best iSC.MEB model from candidated models. — SelectModel","text":"Select best iSC.MEB model candidated models.","code":""},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/SelectModel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Select best iSC.MEB model from candidated models. — SelectModel","text":"","code":"SelectModel(   obj,   criteria = c(\"MBIC\", \"MAIC\", \"BIC\", \"AIC\"),   c_penalty = 1,   K = NULL )  # S3 method for iSCMEBObj SelectModel(   obj,   criteria = c(\"MBIC\", \"MAIC\", \"BIC\", \"AIC\"),   c_penalty = 1,   K = NULL )  # S3 method for SCMEB_Result_Object SelectModel(   obj,   criteria = c(\"MBIC\", \"MAIC\", \"BIC\", \"AIC\"),   c_penalty = 1,   K = NULL )"},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/SelectModel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Select best iSC.MEB model from candidated models. — SelectModel","text":"obj iSCMEBObj object SCMEB_Result_Object object. criteria string, specify criteria used selecting number clusters, supporting \"MBIC\", \"MAIC\", \"BIC\" \"AIC\" (\"MBIC\" default). c_penalty optional positive value, adjusted constant used MBIC criteria (1 default). K optional number cluster. K null, iSC.MEB solution K clusters selected, default NULL.","code":""},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/SelectModel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Select best iSC.MEB model from candidated models. — SelectModel","text":"Returns revised iSCMEBObj object. Returns revised list","code":""},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/SelectModel.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Select best iSC.MEB model from candidated models. — SelectModel","text":"SCMEB_Result_Object object contains iSC.MEB solution information. output function fit.iscmeb, main function package.","code":""},{"path":[]},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/SelectModel.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Select best iSC.MEB model from candidated models. — SelectModel","text":"","code":"data(iSCMEBObj_toy) iSCMEBObj_toy <- SelectModel(iSCMEBObj_toy)"},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/SetModelParameters.html","id":null,"dir":"Reference","previous_headings":"","what":"Set model parameters for iSC.MEB method — SetModelParameters","title":"Set model parameters for iSC.MEB method — SetModelParameters","text":"Set model parameters iSC.MEB method","code":""},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/SetModelParameters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set model parameters for iSC.MEB method — SetModelParameters","text":"","code":"SetModelParameters(   obj,   beta_grid = seq(0, 5, by = 0.2),   maxIter_ICM = 6,   maxIter = 25,   epsLogLik = 1e-05,   verbose = TRUE,   int.model = \"EEE\",   init.start = 1,   Sigma_equal = FALSE,   Sigma_diag = TRUE,   seed = 1,   coreNum = 1,   criteria = c(\"MBIC\", \"MAIC\", \"BIC\", \"AIC\"),   c_penalty = 1 )"},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/SetModelParameters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set model parameters for iSC.MEB method — SetModelParameters","text":"obj iSCMEBObj object. beta_grid optional vector positive value, candidate set smoothing parameter searched grid-search optimization approach, defualt sequence starts 0, ends 5, increase 0.2. maxIter_ICM optional positive value, represents maximum iterations ICM (6 default). maxIter optional positive value, represents maximum iterations EM (25 default). epsLogLik optional positive vlaue, tolerance vlaue relative variation rate observed pseudo log-loglikelihood value, defualt '1e-5'. verbose optional logical value, whether output information ICM-EM algorithm. int.model optional string, specify Gaussian mixture model used evaluting initial values iSC.MEB, default \"EEE\"; see Mclust models' names. init.start optional number times calculate initial value (1 default). init.start larger 1, initial value determined log likelihood mclust results. Sigma_equal optional logical value, specify whether Sigmaks equal, default FALSE. Sigma_diag optional logical value, specify whether Sigmaks diagonal matrices, default TRUE. seed optional integer, random seed fitting iSC.MEB model. coreNum optional positive integer, means number thread used parallel computating (1 default). criteria string, specify criteria used selecting number clusters, supporting \"MBIC\", \"MAIC\", \"BIC\" \"AIC\" (\"MBIC\" default). c_penalty optional positive value, adjusted constant used MBIC criteria (1 default).","code":""},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/SetModelParameters.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set model parameters for iSC.MEB method — SetModelParameters","text":"Returns iSC.MEB object.","code":""},{"path":[]},{"path":"https://github.com/XiaoZhangryy/iSC.MEB/reference/SetModelParameters.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Set model parameters for iSC.MEB method — SetModelParameters","text":"","code":"data(iSCMEBObj_toy) iSCMEBObj_toy <- SetModelParameters(iSCMEBObj_toy) iSCMEBObj_toy@parameterList #> $npcs #> [1] 15 #>  #> $pca.method #> [1] \"APCA\" #>  #> $reduction.name #> [1] \"pca\" #>  #> $platform #> [1] \"Visium\" #>  #> $beta_grid #>  [1] 0.0 0.2 0.4 0.6 0.8 1.0 1.2 1.4 1.6 1.8 2.0 2.2 2.4 2.6 2.8 3.0 3.2 3.4 3.6 #> [20] 3.8 4.0 4.2 4.4 4.6 4.8 5.0 #>  #> $maxIter_ICM #> [1] 6 #>  #> $maxIter #> [1] 25 #>  #> $epsLogLik #> [1] 1e-05 #>  #> $verbose #> [1] TRUE #>  #> $int.model #> [1] \"EEE\" #>  #> $init.start #> [1] 1 #>  #> $Sigma_equal #> [1] FALSE #>  #> $Sigma_diag #> [1] TRUE #>  #> $seed #> [1] 1 #>  #> $coreNum #> [1] 1 #>  #> $criteria #> [1] \"MBIC\" #>  #> $c_penalty #> [1] 4 #>  #> $beta_grid #>  [1] 0.0 0.2 0.4 0.6 0.8 1.0 1.2 1.4 1.6 1.8 2.0 2.2 2.4 2.6 2.8 3.0 3.2 3.4 3.6 #> [20] 3.8 4.0 4.2 4.4 4.6 4.8 5.0 #>  #> $maxIter_ICM #> [1] 6 #>  #> $maxIter #> [1] 25 #>  #> $epsLogLik #> [1] 1e-05 #>  #> $verbose #> [1] TRUE #>  #> $int.model #> [1] \"EEE\" #>  #> $init.start #> [1] 1 #>  #> $Sigma_equal #> [1] FALSE #>  #> $Sigma_diag #> [1] TRUE #>  #> $seed #> [1] 1 #>  #> $coreNum #> [1] 1 #>  #> $criteria #> [1] \"MBIC\" #>  #> $c_penalty #> [1] 1 #>"}]
