<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Fit a iSC.MEB model."><title>Fit a iSC.MEB model. — fit.iscmeb • iSC.MEB</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit a iSC.MEB model. — fit.iscmeb"><meta property="og:description" content="Fit a iSC.MEB model."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">iSC.MEB</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/iSC-MEB.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/iSC.MEB.DLPFC.html">iSC.MEB: DLPFC Data Analysis</a>
    <a class="dropdown-item" href="../articles/iSC.MEB.seqFISH.html">iSC.MEB: seqFISH Data Analysis</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="nav-link" href="https://github.com/XiaoZhangryy/iSC.MEB/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Fit a iSC.MEB model.</h1>
      <small class="dont-index">Source: <a href="https://github.com/XiaoZhangryy/iSC.MEB/blob/HEAD/R/main.R"><code>R/main.R</code></a></small>
      <div class="d-none name"><code>fit.iscmeb.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fit a iSC.MEB model.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit.iscmeb</span><span class="op">(</span></span>
<span>  <span class="va">VList</span>,</span>
<span>  <span class="va">AdjList</span>,</span>
<span>  <span class="va">K</span>,</span>
<span>  beta_grid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, by <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>  maxIter_ICM <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  maxIter <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  epsLogLik <span class="op">=</span> <span class="fl">1e-05</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  int.model <span class="op">=</span> <span class="st">"EEE"</span>,</span>
<span>  init.start <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  Sigma_equal <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  Sigma_diag <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  coreNum <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  criteria <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MBIC"</span>, <span class="st">"MAIC"</span>, <span class="st">"BIC"</span>, <span class="st">"AIC"</span><span class="op">)</span>,</span>
<span>  c_penalty <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>VList</dt>
<dd><p>A list of PCs of log-normalized gene expression matrix. The i-th element is a ni * npcs matrtix, where ni is the number of spots of sample i, and npcs is the number of PC. We provide this interface for those users who would like to define the PCs by their own.</p></dd>


<dt>AdjList</dt>
<dd><p>A list of adjacency matrix with class <code>dgCMatrix</code>. We provide this interface for those users who would like to define the adjacency matrix by their own.</p></dd>


<dt>K</dt>
<dd><p>An integer or integer vector, specify the candidates of number of clusters.</p></dd>


<dt>beta_grid</dt>
<dd><p>An optional vector of positive value, the candidate set of the smoothing parameter to be searched by the grid-search optimization approach, defualt as a sequence starts from 0, ends with 5, increase by 0.2.</p></dd>


<dt>maxIter_ICM</dt>
<dd><p>An optional positive value, represents the maximum iterations of ICM (6 by default).</p></dd>


<dt>maxIter</dt>
<dd><p>An optional positive value, represents the maximum iterations of EM (25 by default).</p></dd>


<dt>epsLogLik</dt>
<dd><p>An optional positive vlaue, tolerance vlaue of relative variation rate of the observed pseudo log-loglikelihood value, defualt as '1e-5'.</p></dd>


<dt>verbose</dt>
<dd><p>An optional logical value, whether output the information of the ICM-EM algorithm.</p></dd>


<dt>int.model</dt>
<dd><p>An optional string, specify which Gaussian mixture model is used in evaluting the initial values for iSC.MEB, default as "EEE"; and see <code>Mclust</code> for more models' names.</p></dd>


<dt>init.start</dt>
<dd><p>An optional number of times to calculate the initial value (1 by default). When init.start is larger than 1, initial value will be determined by log likelihood of mclust results.</p></dd>


<dt>Sigma_equal</dt>
<dd><p>An optional logical value, specify whether Sigmaks are equal, default as <code>FALSE</code>.</p></dd>


<dt>Sigma_diag</dt>
<dd><p>An optional logical value, specify whether Sigmaks are diagonal matrices, default as <code>TRUE</code>.</p></dd>


<dt>seed</dt>
<dd><p>An optional integer, the random seed in fitting iSC.MEB model.</p></dd>


<dt>coreNum</dt>
<dd><p>An optional positive integer, means the number of thread used in parallel computating (1 by default).</p></dd>


<dt>criteria</dt>
<dd><p>A string, specify the criteria used for selecting the number of clusters, supporting "MBIC", "MAIC", "BIC" and "AIC" ("MBIC" by default).</p></dd>


<dt>c_penalty</dt>
<dd><p>An optional positive value, the adjusted constant used in the MBIC criteria (1 by default).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Returns a SCMEB_Result_Object object which contains all model results.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="runPCA.html">runPCA</a></code>, <code><a href="CreateNeighbors.html">CreateNeighbors</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iSCMEBObj_toy</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://satijalab.org/seurat" class="external-link">Seurat</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">XList</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">iSCMEBObj_toy</span><span class="op">@</span><span class="va">seulist</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">Matrix</span><span class="fu">::</span><span class="fu">t</span><span class="op">(</span><span class="va">x</span><span class="op">@</span><span class="va">assays</span><span class="op">$</span><span class="va">RNA</span><span class="op">@</span><span class="va">data</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">VList</span> <span class="op">&lt;-</span> <span class="fu"><a href="runPCA.html">runPCA</a></span><span class="op">(</span><span class="va">XList</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">posList</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">iSCMEBObj_toy</span><span class="op">@</span><span class="va">seulist</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">@</span><span class="va">meta.data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"row"</span>, <span class="st">"col"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">AdjList</span> <span class="op">&lt;-</span> <span class="fu"><a href="CreateNeighbors.html">CreateNeighbors</a></span><span class="op">(</span><span class="va">posList</span>, platform <span class="op">=</span> <span class="st">"Visium"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Neighbors were identified for 4222 out of 4222 spots.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Neighbors were identified for 4378 out of 4381 spots.</span>
<span class="r-in"><span><span class="va">resList</span> <span class="op">&lt;-</span> <span class="fu">fit.iscmeb</span><span class="op">(</span><span class="va">VList</span>, <span class="va">AdjList</span>, K<span class="op">=</span><span class="fl">7</span>, maxIter<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Evaluate initial values...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fitting ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fit SC-MEB2...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Finish variable initialization </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> K = 7, iter = 2, loglik= -148583.924112, dloglik=0.999931 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> K = 7, iter = 3, loglik= -142378.593319, dloglik=0.041763 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> K = 7, iter = 4, loglik= -138932.559873, dloglik=0.024203 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> K = 7, iter = 5, loglik= -135452.994625, dloglik=0.025045 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> K = 7, iter = 6, loglik= -133626.290687, dloglik=0.013486 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> K = 7, iter = 7, loglik= -132565.279798, dloglik=0.007940 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> K = 7, iter = 8, loglik= -131780.626891, dloglik=0.005919 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> K = 7, iter = 9, loglik= -131009.202464, dloglik=0.005854 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> K = 7, iter = 10, loglik= -130602.705279, dloglik=0.003103 </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Xiao Zhang, Wei Liu, Jin Liu.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

